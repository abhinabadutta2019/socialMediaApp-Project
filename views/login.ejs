<%- include('partials/headerWithoutNav') %>

<!--  -->

<div class="container mt-5 pt-5">
  <div class="row justify-content-end">
    <div class="col-lg-6">
      <!-- heading -->
      <div class="text-center text-lg-start">
        <h1 class="display-2 text-primary fw-bold">SocialApp</h1>
        <p class="lead w-75 mx-auto mx-lg-0">
          Helps you connect with your friends and your family
        </p>
      </div>
    </div>

    <div class="col-lg-6 width:100%">
      <div class="bg-white shadow rounded p-3 input-group-lg">
        <!-- form -->
        <form action="#">
          <div class="form-group">
            <label for="username">Username</label>
            <input
              type="text"
              class="form-control"
              id="loginUsername"
              required
            />
          </div>

          <!-- password -->
          <div class="form-group">
            <label for="password">Password</label>
            <input
              type="password"
              class="form-control"
              id="loginPassword"
              required
            />
          </div>
        </form>
      </div>

      <div class="mt-3">
        <!-- form Button -->

        <button
          class="btn btn-primary w-100"
          id="loginButton"
          onclick="onLoginButton()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>

  <script>
    //
    let message = document.getElementById("message");
    //
    async function onLoginButton() {
      //
      try {
        message.textContent = "";
        //
        const username = document.getElementById("loginUsername").value;
        const password = document.getElementById("loginPassword").value;

        //
        const data = { username: username, password: password };

        const response = await fetch(`${window.location.origin}/user/login`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
          //
        });

        //fetch () er result hocche- - login (post) rout er - res.json()-- e jeta set kora hocche( by me)
        const result = await response.json();

        //this line important to get the messages in browser(console)
        // console.log(result);

        if (result.message == "login success") {
          //this line is fireing- router.get("/personalDetails"..
          //etar jonno redirect o hocche - after - get request -- fire hocche
          message.textContent = result.message;
          console.log(result, "result");
          setTimeout(function () {
            //
            window.location.href = `${window.location.origin}/post/timeline/all`;
          }, 1000);
        } else if (result) {
          //
          message.textContent = result.message;
          console.log(result, "result");
          setTimeout(function () {
            //

            //page reload hobe
            window.location.href = window.location.href;
          }, 2000);
        }

        //
      } catch (err) {
        console.log(err);
      }
    }
  </script>

  <%- include('partials/footer') %>
</div>
